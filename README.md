# Intro

This repository is a description for a tool presented in an incomin article.

disCoverage is a software tool to refine calling for structural variants using coverage analysis (so it can only check deletions and duplications).

It takes a list of variants in 4-column bed, and checks whether the coverage in the region agrees with the SV type. This is useful for filtering out wrong callings from variant callers, and to check whether a certain region carries a DEL/DUP.

If you use disCoverage in your research, please read and cite: [TBA].

# Installation

Conda installation coming soon.

# Usage

## Basic usage

### Input data

disCoverage needs an alignment file (BAM) to get coverage data (using the great [Mosdepth](https://github.com/brentp/mosdepth) tool).
It also requires a 4-column bed file with the SVs that need to be checked:

```
chr1	123000000	124000000	DEL
chr2	150000000	150500000	DUP
```

### Basic command

For a single sample:

```bash
disCoverage -bam <bamFile1>.bam -bed <bedFile1>.bed -o <outputDirectory> -i "analysisLabel" -t <threadNumber>
```

Although currently most of running time is consumed by wirting coverage to disk, using 4 or preferibly more threads is recommended.

This will create a series of files: `outputDirectory/P1.analysisLabel.<etc>`

For multiple samples:
```bash
disCoverage -bam <bamFile1>.bam <bamFile2>.bam -bed <bedFile1>.bed <bedFile2>.bed -o <outputDirectory> -i "analysisLabel" -t <threadNumber>
```

This will create `outputDirectory/P1.analysisLabel.<etc>` and `outputDirectory/P2.analysisLabel.<etc>`.

If you wish to change the "P", use the `-p` parameter.

### Second (and subsequent) run

If disCoverage has been run once for a sample, and the coverage files generated by Mosdepth still exists, they can be reused, which will make subsequent runs faster:

```bash
disCoverage --skip-mosdepth -o <outputDirectory> -i "secondLabel" -t <threadNumber> \
	-bam <bamFile1>.bam <bamFile2>.bam \
	-bed <bedFile1>.bed <bedFile1>.bed \
	-cov <P1.firstLabel.per-region.bed.gz> <P2.firstLabel.per-region.bed.gz>
```